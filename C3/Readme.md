# Отбор признаков

С помощью корреляции Пирсона я выяснил что больше всего на выживаемость пациента в отделении интенсивной терапии  влияют показатели: HR, Lactate, Na, GCS, Time (Hour, Minute), BUN, Creatinine, RespRate, HCO3, DiasABP.

# Разбиение набора данных на выборки

Разбил выборки в соотношении 6:2:2 (обучающая:валидационная:тестовая) потому что на валидационную и тестирующую выборки нет необходимости выделять больше данных из данного датасета для данной задачи

# Выбор модели

Целевая переменная, содержит информацию умер человек в отделение интенсивной терапии (1) или нет (0)

Для такой задачи необходимо использовать алгорим классификации

Модели для выбора:
1. RandomForestClassifier
2. KNeighborsClassifier
3. CatBoostClassifier

### Настройка гипер параметров

Пометил гипер параметры и примерный разброс их значений и с помощью HalvingRandomSearchCV подобрал нужные гипер параметры для моделей

Оптимальные параметры:

    'rf': {'n_jobs': -1, 'max_depth': 8, 'criterion': 'entropy'},
    'kn': {'weights': 'distance',
    'n_neighbors': 9,
    'n_jobs': -1,
    'algorithm': 'brute'},
    'cb': {'silent': True, 'iterations': 1500}


## Тестирование моделей

Для тестирования и выбора модели буду использовать метрики F1-score, precision, recall, accurasy.

Отсортировав по всем показателям и вывев таблицы с метриками по классам можно увидеть как определяют разные алгоритмы все классы

Лучше всего пределяет класс 'Умер' алгоритм KNeighborsClassifier, а класс 'Жив' алгоритм RandomForestClassifier поэтому посмотрим метрику accuracy (точность), чтобы решить какой алгоритм справляется лучше с поставленной задачей

У алгоритма RandomForestClassifier точность выше чем у KNeighborsClassifier поэтому я выбираю алгоритм RandomForestClassifier для задачи классификации умер человек в отделение интенсивной терапии или нет

# Сохранение модели

Файлы в Data.zip:
1. db.sqlite - база данных
2. model_r.pkl - обученная модель регрессии
3. model_c.pkl - обученная модель классификации
